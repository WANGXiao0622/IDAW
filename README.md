# 基于刹车压力的停留刹车性能分析

## 1. 背景分析

### a. 故障发生

刹车系统故障是ARJ-21飞机高发问题之一，据不完全统计，2020-2021年刹车系统故障高达53起。以成都航空为例，2020年上半年刹车蓄压器和刹车切断阀故障达13起。

驻留期间刹车压力主要由蓄压器提供，蓄压器压力下降过快，为蓄压器故障表现现象之一。而蓄压器故障会导致中断起飞时刹车性能下降，其风险等级为&quot;危险的&quot;。考虑到航线运营安全，对刹车蓄压器故障的监控和分析显得尤其重要。 ![Shape1](RackMultipart20211104-4-ajk2cm_html_94581dbb9abf9197.gif)

### b. 蓄压器

ARJ-21飞机上刹车系统的蓄压器是活塞式，一端储存液压油，另一端内部充满氮气。当液压系统正常提供液压源时，高压液压油挤压气体端，给气体加压。停机时飞机断电，正常液压源失效，蓄压器向停留/应急刹车提供液压，还可以作为阻尼缓冲装置，减小压力摆动。停留刹车时由两个刹车蓄压器提供液压压力，可以至少保持刹车8 h。

![Shape2](RackMultipart20211104-4-ajk2cm_html_f5b5daee84caca5d.gif)
停留刹车时与蓄压器直接相连的液压元器件有:停留/应急刹车阀(DPEV)、刹车切断阀(SOV)、单向阀(CV)，以及刹车控制阀、转换阀。

停机时，停留刹车液压回路是封闭的不存在外泄漏，停留/应急刹车阀、刹车切断阀正常工作时均存在内泄漏。液压油的内泄漏会导致蓄压器内气体压力逐渐减小速率加快。

根据SOV和DPEV的规范文件，发动机关车后，刹车系统停留刹车正常工作时，停机20min刹车蓄压器压力下降不应大于500psi。

### c. 故障原因分析

 蓄压器压力下降过快的可能原因是停机时液压回路中存在内泄漏过大。因此蓄压器压力下降快的原因应该与停留/应急刹车阀、刹车切断阀、单向阀有关:
   
    1. 内/外轮刹车切断阀内泄漏过大;
    2. 停留刹车应急阀内泄漏过大;
    3. 内/外轮刹车蓄压器故障;
    4. 内/外轮刹车蓄压器单向阀泄漏;
    5. 停留/应急刹车管路中存在气体。
    6. 内/外轮刹车蓄压器预充压不足。

### d. 解决方案

 第一阶段，充分发挥大数据优势，对飞机停场阶段蓄压器作动时期的关键数据进行分析，对同一架机的每一个航段在时间轴上进行横向对比，观测刹车压力变化警惕异常趋势，并提出告警，实现对监控刹车系统驻留性能的监控。

 第二阶段，在积累足量数据后，对模型进一步优化，实现刹车性能自动报警与故障频率统计分析。然后在FLYWIN.Digital平台上部署刹车系统监控模型，通过对多个航空公司ARJ-21飞机航线数据验证原型的有效性、准确性和可靠性，根据发现的问题和客户意见，持续迭代更新模型，对刹车系统异常及时发出告警，实现预测性维修。

## 2. 数据准备

### a. 总体思路

 现有WQAR数据已经能对刹车系统主要数据进行记录，在刹车压力数据中，选取能体现蓄压器性能阶段的刹车压力数据，同时提取同阶段其他数据，作为对比验证，排除异常数据段，提高模型鲁棒性。

 而后在同一架机所有航段计算特征值，分析特征值变化趋势，发现异常情况后，通过航司维修记录，反向验证模型性能，对模型进行持续优化，提高可靠性和准确性，以便日后在FLYWIN.Digital平台上部署，实现对刹车性能的持续监控。

### b. 数据清洗

 在已经采集到的WQAR数据中，除去通用航线信息外，与刹车系统直接相关的数据包括：

    1. 两组正/副驾驶左/右脚蹬位置
    2. 左/右的内轮/外轮刹车压力
    3. 左/右的内轮/外轮刹车温度

 正/副驾驶的脚蹬位置均可以直接影响刹车压力变化。车轮刹车压力变化趋势在停留刹车阶段几乎完全相同。因此我们选取左内轮压力数据进行分析，相对应的，脚蹬位置选取正/副驾驶左脚蹬数据，取同一个采样点脚蹬位移最大值。

 经译码后的WQAR数据，在此研究方案中我们需提取：

    1. 正/副驾驶左脚蹬位移量(BRK\_L\_PDL\_POS1\_CPT)
    2. 主起落架左侧内轮刹车压力(BRK\_PRS\_L\_INBOARD)
    3. 飞行阶段（FLIGHT PHASE）
    4. 时间(UTC)
    5. 标准海拔高度(ALT\_STD)
    6. 大气静温(STA\_AIR\_TEMP)
    7. 马赫数(MACH)
    8. 起降机场(AIRPORT\_ARR\_Cx)

对其中异常数据进行排查，主要包括缺失值、异常值、错误值、数据格式、采样度等问题，便于后续模型计算。

## 3. 刹车建模技术难点

### a. 航段内模态多。

WQAR在开始记录数据时，停留刹车手柄是否拉起或飞机发动机是否启动会影响刹车数据起始点位置，而后在模式识别过程中，蓄压器供压阶段后刹车压力也可能有多种变化，取决于飞行员是否拉起手刹，是否启动发动机。

不同航段蓄压器作动时间也存在较大差异，以B-3388为例，连续两个月的数据中，蓄压器作动阶段最长作动时间为5615s，最小仅为60s。 ![Shape3](RackMultipart20211104-4-ajk2cm_html_d1407ef14e109d1a.gif)

且在此阶段中，蓄压器在不同起始压力下，下降速率不同，起始压力越大下降速率越快。因此需要建立一个标准状况下的蓄压器压力降低模型，将飞机各航段中的实际数据与一个对应起始压力相同的理论标准进行衡量，通过对比评判蓄压器性能。

### b. WQAR数据译码后存在的时序问题。

由于译码问题，数据可能存在时序上的不连续。对应到压力数据上，就会造成压力跳变，通常表现为蓄压器压力骤降，在模型结果上出现噪点或者错误警报，影响模型准确性。

### c. 关键数据缺失。

WQAR参数中没有记录飞行员停留刹车手柄位置数据。

### d. 数据存在噪声。

刹车压力数据噪声主要来自于：压力传感器精度影响；飞行员操作造成的影响。

## 4. 算法模型

### a. 概要

该模型主要实现：  

    1. 建立蓄压器压力标准理论模型；
    2. 准确提取仅蓄压器供压时刹车压力数据；
    3. 该段数据的特征值计算；
    4. 趋势预测与异常警报。

在实际数据处理的过程中，第一步要进行模式识别。需准确提取蓄压器供压阶段压力数据，即准确抓取起始点和终止点，并将由于飞行员脚蹬行程变化、发动机启动和压力传感器精度问题引起的压力数据异常变化排除。

而后需计算特征值。特征值能将原始压力数据转化成更好的表达问题本质的特征，使得将这些特征运用到预测模型中能提高模型预测精度。

最后一步的趋势预测中，根据已有数据，预测数据概率分布，得出一个数据存在的合理区间，再判断后来数据是否在预测合理区间内，如超出预测范围则视为异常值。

### b. 标准理论模型

停留/应急刹车阀、刹车切断阀以及蓄压器的规范文件，规定了ARJ-21飞机在不同刹车压力时液压油不同的最大允许泄漏值。其中停留/应急刹车阀的最大允许泄漏值与蓄压器压力有关：停留/应急刹车阀位于打开状态时，输入端压力为2920psi ±60psi时，其内泄漏不应超过11mL/min;停留/应急刹车阀输入端压力为2000psi±60psi 时，其内泄漏不应超过5mL/min;停留/应急刹车阀输入端压力为 1000psi±60psi时，其内泄漏不应超过1.5mL/min。停留/应急刹车阀位于关闭状态时，当输入端压力为2920psi±60psi 时，其内泄漏不应超过2mL/min。

标准条件下，根据理想气体状态公式: ，计算出蓄压器预充3000psi液压油后，气体容量约为229ml。

停留刹车液压回路中存在内泄漏的元件有SOV 和DPEV。发动机关车后，刹车系统停留刹车正常工作时，时间内液压回路内元件允许的最大的内泄漏液压油体积计算方法如式1:

式中：

—— 间隔时间；

—— 时间内液压油允许的最大内泄漏量；

—— 刹车切断阀的最大内泄漏速度；

—— 停留/应急刹车阀的最大内泄漏速度，通过插值可以得到停留/应急刹车阀输入端不同压力时对应的最大内泄漏速度。

停机时停留刹车液压回路是封闭的不存在外泄漏，因此蓄压器中气体体积变化量等于液压回路中液压油体积变化量，即。液压油体积变化后的蓄压器压力计算方法如式:

式中：

—— 蓄压器内气体压力；

——蓄压器内气体体积；

—— 经过时间后，蓄压器气体压力。

由上式计算可的蓄压器压力在SOV 和DPEV手册规定的最大泄漏量情况下理论模型，如下图4所示： ![Shape4](RackMultipart20211104-4-ajk2cm_html_7f70e10480ae1751.gif)

### c. 实际数据模型

一般情况下，一个航段内刹车压力变化如图5所示： ![Shape5](RackMultipart20211104-4-ajk2cm_html_68b1916946765c7f.gif)

图示说明：

    - 阶段1：停留刹车阶段，刹车压力缓慢平稳下降；
    - 点 1: 手刹放下，飞机准备推出停机位；
    - 点 2: 发动机点火，飞机液压系统开始提供刹车压力；
    - 点 3/阶段2：手刹拉起，飞机短暂停留准备起飞；
    - 阶段3: 飞机在跑道上起飞；
    - 点 4: 飞机升空，起落架收起，止轮刹车系统启动；
    - 阶段4: 巡航阶段；
    - 点 5: 飞机准备降落前启动刹车系统自检程序；
    - 阶段5: 飞机降落，自动刹车系统启动，并于最后一个点拉起手刹停机驻留。

刹车压力的趋势图明显可见，不同阶段过渡时，刹车压力在极短时间内有显著增高或降低，变化趋势明显。因此需充分利用数据的这个特性，设计算法。

#### i.时间序列筛选

对每一个航段数据在时间序列进行排查，剔除时间上不连续的异常数据和重复航段数据。

#### ii. 模式识别

##### (1) 概述

通过对蓄压器作动阶段原理研究和实际数据的观察，一般情况下每个航段飞机起飞前刹车压力有一段较为平稳的下降趋势，因此模型第一步需进行模式识别，准确抓出此段数据。在充分考虑上文所述刹车数据问题后，决定采用贝叶斯变化点检测(Bayesian Change Point Detection, BCPD) 的算法对该段数据进行抓取。

BCPD通过利用已有数据，通过对当前数据段的计算，得出一个数据分布区间，再用此区间去预测下一个点的合理分布范围，若超出此范围，则视为一个变化点(change point)，然后从此变化点开始重新计算新的分布数据范围，并预测下一个点的分布区间。

贝叶斯变化点检测尤其适用于时间序列的分析，因为变化点的存在表明数据生成过程中发生了突然而显着的变化。目前从刹车压力存在突变的角度，用BCPD的方法抓去不同阶段临界变化点是个很好的选择。

大部分BCPD都是离线监测并且采用数据回溯的方法，或者注重于分区(segmentation)和根据先验概率产生样本进行分析。本次采用的贝叶斯变化点检测算法可适用于在线数据监测，该算法专注于对预测结果过滤，而不是数据回溯。

##### (2) 具体实现

假设一整段数据可以被分为n组不同的分布，每组数据拥有相同的分布概率，不同数据之间的分界点就叫做变化点（change point），并从上一个变化点开始记录段数据的运行长度（run length）。 ![Shape6](RackMultipart20211104-4-ajk2cm_html_87e4cab518edba97.gif)

图6(a) 展示了由变化点分割的三组数据，每组长度分别为：, , 未知；图6(b)表示每组数据在时间序轴的运行长度(run length)；图6(c)在网格里显示了消息传递算法。实线表示概率正在&quot;向上&quot;传递，导致运行长度在下一个时间步长增长。虚线表示当前运行被截断并且运行长度降至零。

假设一系列的观察值, ,…, 可以划分为不重叠的分区。分区之间的划分点称为变化点。进一步假设，对于每个分区，其中的数据是来自某个概率分布，每个，符合i.i.d条件。我们将时间a和时间b之间的连续观测集合表示为。在变化点之间的间隔的先验概率分布表示为。

在给定的可变长度，利用边缘概率密度求和，可知:

因此，后验概率为：

注意，预测分布仅取决于最近的数据。

假设每一序列之前的概率值是已知的，那么的概率取决于两种可能性,即变化点发生或变化点没有发生，当行程长度加1。为对此两种可能性进行判断并计算在这两种情况下的概率，需要计算风险函数(Hazard Function）：

其中，

为了提高程序运行效率，仅选取飞行航前的数据，抓取变化点。并从中选出间隔最大的两点，作为初步认定的蓄压器作动阶段刹车压力值。

##### (3) 多次BCPD修正

为了增加模式识别准确度，排除该段模式下数据可能出现的异常跳变，我们对数据采取多次BCPD处理。 ![Shape7](RackMultipart20211104-4-ajk2cm_html_6f96d3e3a05b99fd.gif)

#### iii. 噪声处理

##### (1) 概述

在刹车压力模式识别过程中，数据存在的噪声主要来源是：刹车压力传感器精度影响，造成压力小范围跳变；飞行员频繁拉动手刹造成刹车压力短时间内多次大范围跳变。

此种情况较为常见，因此需要采取滤波器对数据进行平滑处理。考虑到数据特性，我们决定采用Savitzky-Golay滤波器对模式识别中的异常点进行处理。 ![Shape8](RackMultipart20211104-4-ajk2cm_html_cf22922e878a5f4d.gif)

SG滤波器是一种数字滤波器，它所采用的卷积平滑算法是移动平滑算法的改进。它可以应用于一组数据，以平滑数据，即在不改变信号趋势的情况下提高数据的精度。该算法从时域来看，是通过卷积的过程实现，即通过线性最小二乘法将时域内，一定窗口宽度内的数据与一个低次多项式拟合。而从频域上看，这种拟合实际就是通过了低频数据，而滤掉了高频数据。

##### (2) 具体实现

设一个窗口内的一组数据为, 的取值为个连续的整数值，现构造一个阶多项式()来拟合这组数据：

拟合数据点与原数据点的残差平方和为：

使用最小二乘法，要使拟合结果最小，则残差平方和应最小，即对该多项式的系数求偏导应为0:

解得：

需要拟合的单边点数，多项式的阶次，以及待拟合的数据已知后，即可求出该多项式。拟合出来的多项式用来求取该窗口内的中心点估计值，而对于后面的点，不断移动窗口重复操作即可。

进一步求解后可得：

可以看到计算相当于对原始数据进行一次FIR滤波，意味着输入与滤波器的单位冲激响应进行卷积就可以得到输出：

Savitzky和Golay根据这一特点，制定了卷积系数表，根据系数使用离散卷积即可快速得到该窗口内的中心点平滑值。

Savitzky-Golay平滑公式为：

其中，为平滑系数，由最小二乘法拟合多项式求得。

#### iv. 特征值计算

一般情况下，经过完整模式识别后的实际数据与理论数据结果如图9：

![Shape9](RackMultipart20211104-4-ajk2cm_html_367e454309dbe68b.gif)

得到采集完整的实际数据后，在标准理论模型上从同一压力起始点截取相同长度的理论值变化曲线，并通过这两段数据计算以下特征值：

    1. 实际与理论的下降率距离
    2. 实际与理论的序列距离(欧式距离)
    3. 实际最大大下降率
    4. 刹车平均温度
    5. 起降机场
    6. 时间

## 6. 模型验证

### a. 成都航空B-603Q (由故障观察趋势)

B-603Q号机于2021年1月24日执行EU1944贵阳-成都航班，航后发现内轮刹车蓄压器压力下降过快，20 分钟内下 降超过1000psi。航后参考 FIM ARJ21-A-32-40-00-A7A-421A-A，使用液压堵头堵住内轮刹车切断阀的供压 管，打压后观察内轮刹车蓄压器压力下降在手册范围之内，判断为内轮刹车切断阀内漏，参考MPP ARJ21-A-32-41-03，更换内轮刹车切断阀，检查测试正常。

经过模型计算，得出B-603Q在停留刹车阶段蓄压器性能特征值如下图10： ![Shape10](RackMultipart20211104-4-ajk2cm_html_5eedcad537881868.gif)

图中横坐标表示为时间，从2020年9月至2021年6月，纵坐标为实际值与理论值的差，这个值应当小于0为正常，每一个点表示一个航段的数据。

从图中能很直观的看出，在2020年12月20日，首次刹车压力下降率超限，后续一个月内刹车压力下降率持续升高，于事故发生前到达最高值，至1月24故障被发现并维修更换部件，飞机停飞2日。而此模型可以提前一个月发现蓄压器异常工作趋势，因此该模型在该段数据中得到了很好的验证，性能良好，能有效提前发现异常。

### b. 成都航空B-602C(由趋势推测故障)

在利用该模型对其他架机近一年的航段数据进行计算后，发现成都航空B-602C数据从2020年11月24日起，其刹车压力特征值超出物理理论模型定义的正常范围，根据特征值变化趋势，该架机在1月5日后特征值恢复至正常范围，推测在2021年1月3日-5日对刹车系统进行维修。经查阅成都航维修换件记录，证实B-602C架机于1月4日进行了刹车切断阀的更换，该部件的故障正为我们所考虑的刹车故障可能原因，以及模型建立时重点考虑参数之一。 ![Shape11](RackMultipart20211104-4-ajk2cm_html_51abcf9e18122028.gif)

### c. 成都航空B-104X (回测中发现故障)

![Shape12](RackMultipart20211104-4-ajk2cm_html_5b8c565a321fcb7c.gif)

## 7. 预测与告警系统

### a. 概要

#### i. 故障监控系统现状

目前仍停留在人工查验数据，分析异常趋势/发现异常数据点。在监控工作上需派遣专门工作人员，其中人员培训成本、异常情况沟通上造成的时间成本等较大。而目前国际主流制造商已经应用预测报警系统，以更直观、更人性化的方式将异常直接报给客户。

#### ii. 预测与告警系统原理

预测是基于历史样本数据的特性，对未来数据概率分布的一种合理预测。通过对预测结果和新数据的对比，实现对新数据的分类。根据不同分类标准实现不同的异常告警。

考虑到刹车压力数据特性，特征值中最重要，对刹车压力数据特性体现最为明显的是实际与理论的下降率距离。对数据的观察后发现，正常情况下，该数值在0以下的一定范围内呈现离散状态。因此，我们需要一个算法实现对数据正常分布区间的预测，对连续异常数据或极大超出合理范围数据进行告警。该预测与告警系统模型建立采用自回归集成移动平均模型(ARIMA)和贝叶斯神经网络(BNNs)来实现。

#### iii. 模型研究意义

该模型可以使数据结果更具有解释性，不再需要人工实时监控，可实现自动报警，为未来大机队预测性服务打下基础。

### b. 具体实现

#### i. 自回归集成移动平均模型(ARIMA)

自回归模型所采用的自相关性可以预测时间序列的属性，但意料之外的分量变化（震荡）可能对预测值产生较大影响，而刹车压力特征值中可能会出线较大离群值。

移动平均模型根据过去的历史预测偏差对后续序列进行预测，可将预测偏差视为白噪声或者震荡。在时间戳上看，该模型所采用的属性值依赖于时间序列的历史震荡，而不是实际的序列值。

ARIMA是自回归模型和移动平均模型的的结合。在预测时间序列值时，适当的学习自相关性和历史震荡的影响，使用自回归项 和移动回归项 ，不同项之间的联系表示为：

许多情况下，采用查分将自动回归移动平均模型相结合，即可对平稳序列进行处理，即自回归集成移动平均模型。通常情况下采用一阶差分，即模型：

#### ii. 贝叶斯神经网络(BNNs)

贝叶斯神经网络(Bayesian Neural Networks)是一种贝叶斯深度学习模型。该模型通过给出网络模型参数 的先验，得出后验分布，而不是点估计。该过程在传统贝叶斯模型中被称为后验推理，但由于深度学习模型中复杂的非线性和非共轭性，很难获得精确的后验推断。

模型构建中，我们引入MC Dropout框架(Monte Carlo dropoutframework)。它不需要改变现有的模型架构，能够提供准确、稳定且快速的预测，并且几乎可以适用于所有神经网络。它在每个隐藏层(hidden layer)之后都应用了dropout，这样每一层之后的输出就可以近似视为从后验预测分布生成的随机样本。因此，模型的不确定性可以通过几次重复的模型预测的样本方差来估计，该样本方差计算为：

式中，为神经网络结构方程，为数据集，为中的数据。

![Shape13](RackMultipart20211104-4-ajk2cm_html_2f433c959855e5de.gif)

实际应用中，该预测模型对实际刹车压力数据特征值进行处理。将特征值导入特征值工程数据库后，采用神经网络算法，持续训练预测模型，将预测结果通过分类器判别。

经分类器判别后，实现对特征值趋势和趋势上/下边界的预测，对超出上/下边界的数值点判定为异常数值，并为其标注故障权重。

### c. 结果展示

图14展示了B-3388和B-603Q在该模型处理下的预测告警示结果。 ![Shape14](RackMultipart20211104-4-ajk2cm_html_4836675c5b991524.gif)

图中，黑色实线为特征值趋线，蓝色区域上/下边缘为合理范围的上/下边界线，超出合理范围的数据将被特殊标注(红色点)，并提出告警信息。

![Shape15](RackMultipart20211104-4-ajk2cm_html_f9075d077e3acac8.gif)

## 8. 附录

![Shape16](RackMultipart20211104-4-ajk2cm_html_b90871aa534fcd71.gif)

![Shape17](RackMultipart20211104-4-ajk2cm_html_e73260df20bc28fb.gif)
